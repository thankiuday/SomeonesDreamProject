<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Routing Debug - COCOON</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .debug-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-button {
            display: inline-block;
            padding: 10px 20px;
            margin: 5px;
            background: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            border: none;
            cursor: pointer;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        .info { background: #d1ecf1; color: #0c5460; }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="debug-section">
        <h1>üîç Routing Debug Tool</h1>
        <p>This tool helps identify routing issues on your deployment.</p>
    </div>

    <div class="debug-section">
        <h2>üìä Current Environment</h2>
        <div id="environment-info">
            <p><strong>Current URL:</strong> <span id="current-url"></span></p>
            <p><strong>User Agent:</strong> <span id="user-agent"></span></p>
            <p><strong>Protocol:</strong> <span id="protocol"></span></p>
            <p><strong>Host:</strong> <span id="host"></span></p>
        </div>
    </div>

    <div class="debug-section">
        <h2>üß™ Route Testing</h2>
        <p>Click these buttons to test different routes:</p>
        
        <button class="test-button" onclick="testRoute('/')">Test Home (/)</button>
        <button class="test-button" onclick="testRoute('/login')">Test Login</button>
        <button class="test-button" onclick="testRoute('/call/test-123')">Test Video Call</button>
        <button class="test-button" onclick="testRoute('/call/faculty-math01-1756030481231')">Test Faculty Call</button>
        <button class="test-button" onclick="testRoute('/chat/test-123')">Test Chat</button>
        <button class="test-button" onclick="testRoute('/faculty-dashboard')">Test Faculty Dashboard</button>
        
        <div id="test-results"></div>
    </div>

    <div class="debug-section">
        <h2>üìã Configuration Check</h2>
        <div id="config-status">
            <p>Checking configuration files...</p>
        </div>
    </div>

    <div class="debug-section">
        <h2>üîß Manual Tests</h2>
        <p>Try these manual tests:</p>
        <ul>
            <li><strong>Direct URL Test:</strong> <a href="/call/test-123" target="_blank">/call/test-123</a></li>
            <li><strong>Faculty Call Test:</strong> <a href="/call/faculty-math01-1756030481231" target="_blank">/call/faculty-math01-1756030481231</a></li>
            <li><strong>Login Test:</strong> <a href="/login" target="_blank">/login</a></li>
        </ul>
    </div>

    <div class="debug-section">
        <h2>üìù Debug Log</h2>
        <pre id="debug-log">Debug log will appear here...</pre>
    </div>

    <script>
        // Display environment info
        document.getElementById('current-url').textContent = window.location.href;
        document.getElementById('user-agent').textContent = navigator.userAgent;
        document.getElementById('protocol').textContent = window.location.protocol;
        document.getElementById('host').textContent = window.location.host;

        const debugLog = document.getElementById('debug-log');
        const testResults = document.getElementById('test-results');
        const configStatus = document.getElementById('config-status');

        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            debugLog.textContent += `[${timestamp}] ${message}\n`;
            debugLog.scrollTop = debugLog.scrollHeight;
        }

        function testRoute(route) {
            log(`Testing route: ${route}`);
            
            fetch(route)
                .then(response => {
                    const status = response.status;
                    const statusText = response.statusText;
                    
                    log(`Route ${route}: ${status} ${statusText}`);
                    
                    if (status === 200) {
                        testResults.innerHTML += `<div class="status success">‚úÖ ${route}: ${status} ${statusText}</div>`;
                    } else if (status === 404) {
                        testResults.innerHTML += `<div class="status error">‚ùå ${route}: ${status} ${statusText}</div>`;
                    } else {
                        testResults.innerHTML += `<div class="status warning">‚ö†Ô∏è ${route}: ${status} ${statusText}</div>`;
                    }
                })
                .catch(error => {
                    log(`Error testing ${route}: ${error.message}`);
                    testResults.innerHTML += `<div class="status error">‚ùå ${route}: Network Error</div>`;
                });
        }

        // Check configuration files
        function checkConfig() {
            const configFiles = [
                '/_redirects',
                '/_headers',
                '/vercel.json',
                '/netlify.toml'
            ];

            let configChecks = 0;
            let configPassed = 0;

            configFiles.forEach(file => {
                fetch(file)
                    .then(response => {
                        configChecks++;
                        if (response.ok) {
                            configPassed++;
                            log(`‚úÖ Config file found: ${file}`);
                        } else {
                            log(`‚ùå Config file missing: ${file} (${response.status})`);
                        }

                        if (configChecks === configFiles.length) {
                            if (configPassed === configFiles.length) {
                                configStatus.innerHTML = `
                                    <div class="status success">
                                        ‚úÖ All configuration files found (${configPassed}/${configChecks})
                                    </div>
                                    <p>Routing configuration should be working.</p>
                                `;
                            } else {
                                configStatus.innerHTML = `
                                    <div class="status warning">
                                        ‚ö†Ô∏è Some configuration files missing (${configPassed}/${configChecks})
                                    </div>
                                    <p>This might cause routing issues.</p>
                                `;
                            }
                        }
                    })
                    .catch(error => {
                        configChecks++;
                        log(`‚ùå Error checking ${file}: ${error.message}`);
                        
                        if (configChecks === configFiles.length) {
                            configStatus.innerHTML = `
                                <div class="status error">
                                    ‚ùå Configuration check failed (${configPassed}/${configChecks})
                                </div>
                                <p>There are configuration issues.</p>
                            `;
                        }
                    });
            });
        }

        // Initialize
        log('Debug tool initialized');
        checkConfig();
        
        // Test basic routes on load
        setTimeout(() => {
            testRoute('/');
            testRoute('/login');
            testRoute('/call/test-123');
        }, 1000);
    </script>
</body>
</html>
